<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Create New Year 2026 Gift</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0a0530" />
  <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

</head>

<body class="create-body">
  <header class="top-bar fade-in">

    <div class="logo-text" style="display: flex;justify-content: space-between;align-items: flex-start;width: 100%;">
      Create Your NY2026 Gift</div>
    <button id="themeToggle" class="theme-btn">â˜€ï¸</button>

    <a href="celebrate.html" class="top-link">Have a Gift?</a>
  </header>

  <main class="container two-column fade-in">

    <section class="card create-card">
      <h1>Create a Celebration Link</h1>
      <p class="helper-text">
        Fill this form and send a magical Happy New Year 2026 celebration link to your friend.
      </p>

      <div class="form-group">
        <label for="senderName"><b>Your Name</b></label>
        <input type="text" id="senderName" placeholder="e.g., Bhaskar" autocomplete="name" />
      </div>

      <div class="form-group">
        <label for="friendName"><b>Friendâ€™s Name</b></label>
        <input type="text" id="friendName" placeholder="e.g., Dip" />
      </div>

      <div class="form-group">
        <label for="photo"><b>Friendâ€™s Photo (optional)</b></label>
        <input type="file" id="photo" accept="image/*" />
        <small style="color:#888;">Photo is optional. If skipped, a festive emoji will appear instead.</small>
      </div>
      <br>
      <label class="input-label">Choose Template</label>
      <select id="templateSelect" class="input" style="color:rgb(2, 22, 244);">
        <option value="default">Default</option>
        <option value="love">Love Theme</option>
        <option value="friendship">Friendship Theme</option>
        <option value="family">Family Theme</option>
        <option value="professional">Professional Theme</option>
        <option value="neon">Neon Theme</option>
      </select><br>
      <label class="input-label">Select Music</label>
      <select id="musicSelect" class="input" style="color:rgb(244, 2, 201);">
        <option value="default">Default Music</option>
        <option value="happy">Happy Celebration</option>
        <option value="romantic">Romantic Soft</option>
        <option value="party">DJ Party Mix</option>
        <option value="none">No Music</option>
      </select>
      <br><br>
      <div class="form-group">
        <label for="customMessage"><b>Optional Custom Wish Massage</b></label>
        <textarea id="customMessage" rows="3" placeholder="Write a special New Year message..."></textarea>
        <span id="typingCursor" style="display:none;"></span>
        <div id="aiBubble" style="
  display:none;
  background:#262637;
  color:#fff;
  padding:12px;
  border-radius:12px;
  margin-top:10px;
  border:1px solid #444;
"></div>
        <div id="aiThinking" style="
  display:none;
  text-align:center;
  font-weight:600;
  margin-bottom:10px;
  font-size:16px;
">
          AI is thinking<span id="thinkDots">.</span>
        </div>
      </div>
      <p>OR,</p>
      <p>Generate âœ¨AI Wish Massage :</p>
      <!-- Language Selector -->
      <div style="margin-top:10px;">
        <select id="wishLanguage" class="btn" style="width:100%; padding:10px;">
          <option value="">Select Wishing Language</option>
          <option value="en">English</option>
          <option value="bn">Bengali</option>
          <option value="hi">Hindi</option>
        </select>
      </div>


      <!-- Category Buttons -->
      <p>Choose Wish Category ğŸ‘‡ </p>
      <div id="wishCategories" style="margin-top:10px;">
        <button class="btn" data-cat="love">â¤ï¸ Love</button>
        <button class="btn" data-cat="friendship">ğŸ¤ Friendship</button>
        <button class="btn" data-cat="family">ğŸ‘ª Family</button>
        <button class="btn" data-cat="funny">ğŸ˜‚ Funny</button>
        <button class="btn" data-cat="emotional">ğŸ’– Emotional</button>
        <button class="btn" data-cat="professional">ğŸ’¼ Professional</button>
      </div>

      <!-- Generate Multiple Wishes -->
      <div style="margin-top:10px;">
        <button id="generateThreeBtn" class="btn secondary-ai" style="width:100%; margin-top:5px;">
          ğŸ¤– Generate 3 AI Wishes
        </button>


      </div>
      <br>
      <button id="generateBtn" class="btn primary final-action pulse-btn gradient-border"
        style="width:100%; margin-top:12px; position:relative; overflow:hidden;">

        <canvas class="firework-canvas"></canvas>


        Generate Celebration Link
        <span class="gift-emoji">ğŸ</span>
      </button>



      <div id="status" class="status-text"></div>
      <!-- AI Loader -->
      <div id="aiLoader" style="
  display:none;
  margin-top:10px;
  font-size:16px;
  color:#555;
  font-weight:600;
">
        Generating<span id="aiDots">.</span>
      </div>


      <div id="linkResult" class="result-block" style="display: none;">
        <h3>Your Shareable Link</h3>
        <p>Copy and send this to your friend:</p>
        <p id="resultLink" class="link-display"></p>
        <div style="margin-top:8px; display:flex; gap:8px;">
          <button id="copyLinkBtn" class="btn fade-in">Copy Link</button>
          <button id="openLinkBtn" class="btn fade-in">Open Link to View</button>
        </div>
        <p>Share With...</p>
        <div id="shareButtons" style="margin-top:18px; display:flex; gap:8px; flex-wrap:wrap;">
          <button class="btn fade-in" id="shareWhatsapp" style="color: rgb(82, 237, 5);">WhatsApp</button>
          <button class="btn fade-in" id="shareTelegram" style="color: rgb(2, 224, 244);">Telegram</button>
          <button class="btn fade-in" id="shareFacebook" style="color: rgb(5, 94, 237);">Facebook</button>
        </div>
        <div id="qrSection" style="margin-top:12px; display:none; text-align:center;">
          <h3>Your QR Code</h3>
          <div id="qrcode" style="padding:10px; background:#fff; border-radius:12px; display:inline-block;"></div>
          <br><br>
          <button id="downloadQR" class="btn fade-in">Download QR</button>
        </div>


      </div>
    </section>

    <section class="card info-card" style="padding-bottom: 20px;">
      <h2 style="margin-bottom: 10px;">How to Create Your Celebration Link</h2>

      <ul style="list-style: none; padding: 0; margin: 0; line-height: 1.6; color: #ddd;">

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ“</span>
          <span><strong>Enter Your Details</strong><br>Type your name & your friendâ€™s name.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ“¸</span>
          <span><strong>Upload a Photo (Optional)</strong><br>Add your friendâ€™s picture or skip it.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ¨</span>
          <span><strong>Choose a Template</strong><br>Select Default, Love, Family, Friendship, Professional, or Neon
            themes.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸµ</span>
          <span><strong>Select Music</strong><br>Pick background music for the celebration.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ’¬</span>
          <span><strong>Write a Wish (Optional)</strong><br>Or use AI Wish Generator in your language.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">âœ¨</span>
          <span><strong>Click â€œGenerate Celebration Linkâ€</strong><br>App shows full-screen animation: Preparing â†’
            Uploading â†’ Saving â†’ Done.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ‰</span>
          <span><strong>Success Popup</strong><br>Your celebration link is ready to use.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ”—</span>
          <span><strong>Get Your Shareable Link</strong><br>Copy it, preview it, or share via WhatsApp, Telegram,
            Facebook.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ“±</span>
          <span><strong>Generate a QR Code</strong><br>Download and share the QR anywhere.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸ</span>
          <span><strong>Your Friend Opens the Gift</strong><br>Gift box â†’ Opening animation â†’ Name reveal â†’ Wish â†’
            Music.</span>
        </li>

        <li style="margin-bottom: 14px; display:flex; align-items:flex-start; gap:10px;">
          <span style="font-size:22px;">ğŸŒ</span>
          <span><strong>Works Everywhere</strong><br>Android, iPhone, Laptop, Browser, and Installed PWA.</span>
        </li>

      </ul>
    </section>


  </main>

  <section class="card slide-up" id="leaderboard-card" slide-up>
    <h3>ğŸ† Global Leaderboard</h3>
    <ul id="leaderboard-list" style="list-style:none; padding:0; margin:10px 0 0 0;"></ul>
    <div id="your-rank"></div>
  </section>

  <footer class="footer-bar">
    Â© 2026 Happy New Year â€” Created by Bhaskar Charan
  </footer>



  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <!-- Popup Modal for Selecting Wishes (fixed wrapper + inner) -->


  <div id="wishPopup" style="
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.55);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 9999;">
    <div id="wishPopupInner" class="ai-popup" style="
    background: #fff;
    padding: 20px;
    width: 90%;
    max-width: 420px;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
  ">
      <h3 style="margin-bottom: 10px; text-align: center;">Select Your Wish</h3>

      <div id="popupWishList"></div>

      <button id="closePopup" class="btn" style="margin-top: 15px; width: 100%;">Close</button>
    </div>
  </div>
  <audio id="typeSound">
    <source src="assets/sounds/typewriter_click.wav" type="audio/wav">
  </audio>





  <script src="create.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js').catch(e => console.warn('SW register failed', e));
    }
  </script>
  <script>
    let keyBuffer = "";

    document.addEventListener("keydown", (e) => {
      if (!e.key) return; // FIX: prevents undefined error
      keyBuffer += e.key.toLowerCase();


      // If admin secret code is typed
      if (keyBuffer.includes("admin")) {
        window.location.href = "admin.html";
      }

      // reset buffer every 10 characters 
      if (keyBuffer.length > 10) keyBuffer = "";
    });
  </script>

  <script>
    // ===========================
    // LONG PRESS ADMIN ACCESS
    // ===========================
    let pressTimer = null;

    function startPress(event) {
      pressTimer = setTimeout(() => {
        window.location.href = "admin.html";
      }, 4000); // 4 seconds
    }

    function endPress() {
      clearTimeout(pressTimer);
    }

    document.addEventListener("DOMContentLoaded", () => {
      const logo = document.querySelector(".logo-text");
      if (!logo) return;

      // Mobile touch
      logo.addEventListener("touchstart", startPress);
      logo.addEventListener("touchend", endPress);

      // Desktop mouse
      logo.addEventListener("mousedown", startPress);
      logo.addEventListener("mouseup", endPress);
      logo.addEventListener("mouseleave", endPress);
    });
  </script>

  <script>
    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault();
      window.deferredPrompt = e;

      // Optional: Add a button UI later for â€œInstall Appâ€
      console.log("PWA install available");
    });
  </script>
  <div id="fullPageLoader" style="
  position:fixed; inset:0; 
  background:rgba(0,0,0,0.85);
  color:white;
  font-size:22px;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999999;
  flex-direction:column;
">
    <div class="loader-ring"></div>
    <div id="loaderStepText" style="margin-top:12px;">Preparingâ€¦</div>
  </div>

  <div id="successPopup" style="
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,0.65);
  align-items:center; justify-content:center;
  z-index:999999;
">
    <div style="
   background:#fff; padding:20px;
   border-radius:12px; text-align:center;
   max-width:300px;
 ">
      <h3 style="color: rgb(38, 0, 255);">ğŸ‰ Link Generated Successfully!</h3>
      <button id="popupOkBtn" class="btn">OK</button>
    </div>
  </div>

  <script>
    document.getElementById("popupOkBtn").onclick = () => {
      document.getElementById("successPopup").style.display = "none";
    };
  </script>

</body>

</html>